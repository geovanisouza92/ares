# Main script
var repos = updateUsing({git : "E:\\Repos\\GIT", hg : "E:\\Repos\\HG", svn : "E:\\Repos\\SVN"});
WriteLn(repos);
System("PAUSE");

def updateUsing(args: Array)
begin
  var dirs = new Array();
  for pair in args do
  begin
    var cmd = "PAUSE";
    case pair.Key
      on "git" do
        cmd = "git pull";
      on "hg" do
        cmd = "hg up";
      on "svn" do
        cmd = "svn up";
    else begin
        WriteLn("CVS nao reconhecibegin");
        System(cmd);
        return;
      end
    end
    WriteLn("=== ${pair.Key}:up");
    System.Directory.Chan;
    var subRepos = System.Directory.ListDirectories;
    for subRepo in subRepos do begin
      WriteLn(">>> ${subRepo}");
      System.Directory.Chan;
      System(cmd);
      WriteLn("<<< ${subRepo}");
      System.Directory.Chan;
      WriteLn;
      dirs.Add("${pair.Value}\\${subRepo}");
    end
  rescue
    on foo do
      foo();
  end
  Result = dirs;
end
